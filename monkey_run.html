<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Monkey Run üêµ</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Courier New', monospace; }
    body { background: linear-gradient(to bottom, #444 0%, #222 100%); color: white; text-align: center; }
    canvas { display: block; margin: 1rem auto; background: #111 url('https://www.transparenttextures.com/patterns/dark-mosaic.png'); border: 3px solid #00ffcc; }
    h1 { margin-top: 1rem; color: #00ffcc; text-shadow: 0 0 10px #00ffcc; }
    #controls { margin: 1rem auto; max-width: 400px; }
    input[type="text"] { padding: 0.5rem; font-size: 1rem; width: 60%; margin-right: 10px; }
    button { padding: 0.5rem 1rem; font-size: 1rem; background: #00ffcc; border: none; cursor: pointer; }
    button:hover { background: #00e6b8; }
    #score, #gameOver, #leaderboard { margin-top: 1rem; font-size: 1.2rem; }
    #gameOver { color: red; font-weight: bold; }
    #leaderboard ul { list-style: none; padding: 0; }
  </style>
</head>
<body>

<h1>üêµ Monkey Run</h1>

<div id="controls">
  <input type="text" id="playerName" placeholder="Enter your name..." />
  <button onclick="startGame()">Start Game</button>
</div>

<canvas id="gameCanvas" width="800" height="300"></canvas>

<div id="score">Score: 0</div>
<div id="gameOver"></div>

<div id="leaderboard">
  <h2>üèÜ Top 5 Monkeys</h2>
  <ul id="topScores"></ul>
</div>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  let monkey = { x: 50, y: 250, width: 30, height: 30, vy: 0, isJumping: false, isDucking: false };
  let obstacles = [];
  let score = 0;
  let isGameOver = false;
  let gravity = 1;
  let gameSpeed = 6;
  let playerName = '';
  let topScores = [];

  document.addEventListener("keydown", (e) => {
    if (e.code === "Space" && !monkey.isJumping) {
      monkey.vy = -15;
      monkey.isJumping = true;
    }
    if (e.code === "ArrowDown") {
      monkey.isDucking = true;
    }
  });

  document.addEventListener("keyup", (e) => {
    if (e.code === "ArrowDown") {
      monkey.isDucking = false;
    }
  });

  function drawMonkey() {
    ctx.fillStyle = "brown";
    const height = monkey.isDucking ? 20 : monkey.height;
    ctx.fillRect(monkey.x, monkey.y, monkey.width, height);
  }

  function drawObstacle(obs) {
    ctx.fillStyle = "gray";
    ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
  }

  function updateMonkey() {
    monkey.y += monkey.vy;
    monkey.vy += gravity;
    if (monkey.y >= 250) {
      monkey.y = 250;
      monkey.vy = 0;
      monkey.isJumping = false;
    }
  }

  function addObstacle() {
    const height = Math.random() > 0.5 ? 30 : 60;
    obstacles.push({ x: canvas.width, y: 300 - height, width: 20, height });
  }

  function checkCollision() {
    const monkeyHeight = monkey.isDucking ? 20 : monkey.height;
    return obstacles.some(obs =>
      monkey.x < obs.x + obs.width &&
      monkey.x + monkey.width > obs.x &&
      monkey.y < obs.y + obs.height &&
      monkey.y + monkeyHeight > obs.y
    );
  }

  function drawBackground() {
    ctx.fillStyle = "#111";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#333";
    for (let i = 0; i < canvas.width; i += 40) {
      ctx.fillRect(i, 280, 20, 20); // Sad pixel floor
    }
  }

  function updateGame() {
    if (isGameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBackground();
    drawMonkey();
    updateMonkey();

    obstacles.forEach((obs, i) => {
      obs.x -= gameSpeed;
      drawObstacle(obs);
    });

    if (Math.random() < 0.02) addObstacle();

    obstacles = obstacles.filter(obs => obs.x + obs.width > 0);

    if (checkCollision()) {
      endGame();
      return;
    }

    score++;
    document.getElementById("score").innerText = `Score: ${score}`;
    requestAnimationFrame(updateGame);
  }

  function endGame() {
    isGameOver = true;
    document.getElementById("gameOver").innerText = `üíÄ Game Over, ${playerName}! Final score: ${score}`;
    updateLeaderboard(playerName, score);
  }

  function updateLeaderboard(name, score) {
    topScores.push({ name, score });
    topScores.sort((a, b) => b.score - a.score);
    topScores = topScores.slice(0, 5);

    const list = document.getElementById("topScores");
    list.innerHTML = "";
    topScores.forEach((entry, index) => {
      const li = document.createElement("li");
      li.textContent = `${index + 1}. ${entry.name} ‚Äî ${entry.score}`;
      list.appendChild(li);
    });
  }

  function startGame() {
    playerName = document.getElementById("playerName").value.trim();
    if (!playerName) {
      alert("Enter your name first!");
      return;
    }
    score = 0;
    isGameOver = false;
    monkey = { x: 50, y: 250, width: 30, height: 30, vy: 0, isJumping: false, isDucking: false };
    obstacles = [];
    document.getElementById("gameOver").innerText = "";
    updateGame();
  }
</script>

</body>
</html>
